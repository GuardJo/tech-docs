> HTTPS 관련 내용 정리
# 1. HTTPS 프로토콜
[[http|HTTP]]에 암호화가 추가된 프로토콜로, 기본적으론 443 Port를 통해 데이터를 송수신한다.
![](images/Pasted%20image%2020231217162305.png)
기존 [[http|HTTP]] 프토로콜의 경우 데이터 송수신간 plain하게 전달하기에 중간에 탈취될 위험이 컸다. 이에 대해 보안적인 해결책으로 SSL 인증을 [[http|HTTP]] 요청 앞에 진행함으로써 암호화된 데이터를 송수신하는 프로토콜이다.

TCP/IP 프로토콜과 [[http|HTTP]] 프로토콜 사이에 위치해 있기에 서버/클라이언트 데이터 송수신 간 모든 패킷을 암호화 하게 된다.


# 2. HTTPS 특징
## 2-1. 암호화
HTTPS의 경우 [[../CS/security/Key_Encryption_Method|대칭키 암호화 방식과 비대칭키 암호화 방식]] 둘 모두를 사용하여 [[http|HTTP]]프로토콜을 통해 송수신는 모든 데이터들을 암호화 하여 전송한다.
## 2-2. 인증서
HTTPS는 브라우저에게 응답 데이터와 함께 인증서 정보를 함께 보내준다.
해당 인증서를 바탕으로 클라이언트(브라우저)는 인증 기관 (CA)이 발급한 인증서인지 여부 검증를 진행하며, 검증되지 않은 경우 관련 경고를 보여준다.
>[!NOTE]
>**SSL/TLS**
>
>HTTPS에서 서버 <-> 클라이언트 간 통신 과정에서 암/복호화에 필요한 서버의 공개키에 대한 정보를 지닌 인증서 및 인증 과정을 SSL이라고 한다.
>허나 요새는 SSL에 대한 여러 취약점에 따라 SSL의 상위 버전인 TLS를 대부분 사용하는 추세이다.
>실제로 CA 에서 SSL 인증서라고 하는 대부분의 인증서는 TLS 이다.




# 3. HTTPS 동작 과정
HTTPS의 경우 데이터 암복호화를 [[../CS/security/Key_Encryption_Method|대칭키 암호화 방식]] 으로 이룬다. 이는 빠른 데이터 전달을 위해 상대적으로 빠른 암복호화 기능을 지닌 [[../CS/security/Key_Encryption_Method|대칭키 암호화 방식]] 이 적합하였기 때문으로 보인다.

단, 위와 같이 암복호화에 쓰일 대칭키는 클라이언트에게 그대로 보내지 않고, [[../CS/security/Key_Encryption_Method|비대칭키 암호화 방식]]으로 보내게 된다.
- 암복호화에 쓰이는 대칭키가 그대로 평문으로 갈 경우 탈취 위험이 높기 떄문이다.

## 3-1. 대칭키 전달 과정

![](images/Pasted%20image%2020231217163907.png)

1. 클라이언트에서 서버로 연결 시도
2. 서버는 공개키(인증서)를 클라이언트에게 전달
3. 클라이언트는 인증서 검증 후 인증서 내 공개키를 복호화하여 세션 키를 획득
4. 클라이언트는 해당 세션키를 보관하며, 서버에게 세션키를 공개키로 암호화하여 전달
5. 서버는 개인키로 복호화하여 세션키를 획득
6. 클라이언트와 서버가 동일한 세션키, 즉 대칭키를 지닌 형태로 데이터 암/복호화 송수신 진행
## 3-2. 비대칭 키 전달 과정
앞선 대칭키 전달 과정에서 암호화된 대칭키를 복호화 하기 위해서는 서버에서 공개키를 클라이언트에게 전달해주어야 한다.
해당 과정은 서버 측에서 공개키를 인증 기관 (Certificate Authority : CA)에 전달하면, CA 에서 해당 공개키를 기반으로 인증서를 발급해준다. 

![](images/Pasted%20image%2020231217164556.png)
1. CA에서 서버의 공개키를 기반으로 CA의 개인키로 암호화된 인증서를 서버에 전달
2. 서버는 전달받은 인증서를 연결 요청하는 클라이언트(브라우저)들에게 전달
3. 브라우저는 CA의 공개키를 미리 지니고 있기에 해당 키로 인증서 복호화
4. 복호화하여 얻은 서버의 공개키를 기반으로 세션키를 공유함

>[!NOTE]
>클라이언트 입장에서는 CA가 개인키로 암호화한 인증서를 공개키로 복호화가 되었기에 CA에서 발급한 인증서라는 신뢰성을 획득할 수 있으며, 인증서를 복호화하여 얻은 공개키는 연결 요청한 서버의 공개키이기에 해당 서버에서만 데이터를 복호화할 수 있어, 보안성도 획득 할 수 있다.
# Ref
- https://mangkyu.tistory.com/98
- https://velog.io/@usreon/%EC%9D%B8%EC%A6%9D%EB%B3%B4%EC%95%88-HTTPS-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C
- https://velog.io/@dnjscksdn98/HTTP-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC
- https://kanoos-stu.tistory.com/46